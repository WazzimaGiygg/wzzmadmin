// --- Configuração do Firebase com suas chaves e dados originais ---
        const firebaseConfig = {
            apiKey: "AIzaSyB9GkSqTIZ0kbVsba_WOdQeVAETrF9qna0",
            authDomain: "wzzm-ce3fc.firebaseapp.com",
            projectId: "wzzm-ce3fc",
            storageBucket: "wzzm-ce3fc.appspot.com",
            messagingSenderId: "249427877153",
            appId: "1:249427877153:web:0e4297294794a5aadeb260",
            measurementId: "G-PLKNZNFCQ8"
        };

        let app;
        try {
            app = firebase.app();
        } catch (e) {
            app = firebase.initializeApp(firebaseConfig);
        }
        const firestore = firebase.firestore();

        const articlesListDiv = document.getElementById('articles-list');
        const loadingMessage = document.getElementById('loading-message');
        const errorDisplay = document.getElementById('error-display');
        const addArticleBtn = document.getElementById('add-article-btn');

        function displayError(message) {
            if (errorDisplay) {
                errorDisplay.textContent = `Erro: ${message}`;
                errorDisplay.style.display = 'block';
            } else {
                console.error("Elemento 'error-display' não encontrado no DOM.");
            }
            if (loadingMessage) {
                loadingMessage.style.display = 'none';
            }
        }

        async function loadArticles() {
            if (!articlesListDiv) {
                console.error("Elemento 'articles-list' não encontrado. Não é possível carregar artigos.");
                displayError("Erro interno: Contêiner de artigos não encontrado.");
                return;
            }

            articlesListDiv.innerHTML = '';
            if (loadingMessage) {
                loadingMessage.style.display = 'block';
            }
            errorDisplay.style.display = 'none';

            try {
                // *** MODIFICAÇÃO AQUI: Mude 'articles' para 'articlesdoc' ***
                const articlesRef = firestore.collection('articlesdoc').orderBy('timestamp', 'desc');
                const snapshot = await articlesRef.get();

                if (loadingMessage) {
                    loadingMessage.style.display = 'none';
                }

                // *** MODIFICAÇÃO AQUI: Atualize a mensagem se a coleção 'articlesdoc' estiver vazia ***
                if (snapshot.empty) {
                    articlesListDiv.innerHTML = '<p class="empty-state">Nenhum artigo (articlesdoc) publicado ainda.</p>';
                    console.log("Nenhum artigo encontrado na coleção 'articlesdoc'.");
                    return;
                }

                snapshot.forEach(doc => {
                    const articleData = doc.data();
                    const articleId = doc.id; // O ID ainda é o ID do documento

                    if (articleData && typeof articleData === 'object') {
                        const card = document.createElement('div');
                        card.className = 'article-card mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-cell--12-col-phone';
                        card.innerHTML = `
                            <div class="mdl-card__title">
                                <h2 class="mdl-card__title-text">${articleData.title || 'Título Indisponível'}</h2>
                            </div>
                            <div class="mdl-card__supporting-text">
                                <p>${articleData.summary || 'Nenhum resumo disponível.'}</p>
                            </div>
                            <div class="mdl-card__actions mdl-card--border">
                                <a href="#" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect edit-article-button" data-article-id="${articleId}">
                                    Editar
                                </a>
                                <button class="mdl-button mdl-button--accent mdl-js-button mdl-js-ripple-effect delete-article-button"
                                        data-article-id="${articleId}">
                                    Excluir
                                </button>
                            </div>
                        `;
                        articlesListDiv.appendChild(card);
                    } else {
                        // *** MODIFICAÇÃO AQUI: Atualize a mensagem de aviso para refletir 'articlesdoc' ***
                        console.warn(`Documento com ID ${articleId} na coleção 'articlesdoc' possui dados inválidos, nulos ou indefinidos. Ignorando este artigo.`);
                    }
                });

                if (window.componentHandler) {
                    window.componentHandler.upgradeElements(articlesListDiv);
                }

            } catch (error) {
                // *** MODIFICAÇÃO AQUI: Atualize a mensagem de erro para refletir 'articlesdoc' ***
                console.error("Erro ao carregar artigos da coleção 'articlesdoc':", error);
                displayError(`Não foi possível carregar os artigos (articlesdoc). Verifique as permissões ou a existência da coleção. ${error.message}`);
            }
        }

        // A função deleteArticle também precisa ser modificada para usar 'articlesdoc'
        async function deleteArticle(articleId) {
            if (!confirm('Tem certeza que deseja excluir este artigo? Esta ação é irreversível.')) {
                return;
            }

            try {
                // *** MODIFICAÇÃO AQUI: Mude 'articles' para 'articlesdoc' ***
                await firestore.collection('articlesdoc').doc(articleId).delete();
                alert('Artigo excluído com sucesso!');
                // *** MODIFICAÇÃO AQUI: Atualize a mensagem de log ***
                console.log(`Artigo com ID ${articleId} excluído da coleção 'articlesdoc'.`);
                loadArticles(); // Recarrega a lista após a exclusão
            } catch (error) {
                // *** MODIFICAÇÃO AQUI: Atualize a mensagem de erro ***
                console.error("Erro ao excluir artigo da coleção 'articlesdoc':", error);
                displayError(`Não foi possível excluir o artigo (articlesdoc). ${error.message}`);
            }
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            loadArticles();

            if (articlesListDiv) {
                articlesListDiv.addEventListener('click', (event) => {
                    const target = event.target;

                    // Lógica para o botão Excluir
                    if (target.classList.contains('delete-article-button') && target.dataset.articleId) {
                        const articleId = target.dataset.articleId;
                        deleteArticle(articleId); // Esta função já foi modificada acima
                    }
                    // Lógica para o botão Editar - O URL para o editor ainda pode ser o mesmo, apenas o ID do documento é passado.
                    if (target.classList.contains('edit-article-button') && target.dataset.articleId) {
                        event.preventDefault(); // Evita que o link navegue o iframe diretamente

                        const articleId = target.dataset.articleId;
                        const urlToLoad = `./admintools/editordeartigos.html?id=${articleId}`; // O ID do documento é passado para o editor

                        // Comunica com a janela pai para carregar a URL no iframe principal
                        if (window.parent !== window && window.parent.postMessage) {
                            window.parent.postMessage({
                                type: 'navigateIframe',
                                url: urlToLoad
                            }, window.location.origin); // Use window.location.origin para segurança
                        } else {
                            // Fallback se não estiver em um iframe (ex: testando diretamente a página)
                            window.location.href = urlToLoad;
                        }
                    }
                });
            } else {
                console.error("Elemento 'articles-list' não encontrado para adicionar listeners.");
            }

            // Lógica para o botão "Adicionar Novo Artigo" - A navegação continua sendo para o editor
            if (addArticleBtn) {
                addArticleBtn.addEventListener('click', (event) => {
                    event.preventDefault(); // Impede o comportamento padrão do link

                    const urlToLoad = './admintools/editordeartigos.html'; // URL para o editor de artigos (onde você criará o novo documento em 'articlesdoc')

                    if (window.parent !== window && window.parent.postMessage) { // Se estiver em um iframe
                        window.parent.postMessage({
                            type: 'navigateIframe',
                            url: urlToLoad
                        }, window.location.origin); // Use window.location.origin para segurança
                    } else { // Se não estiver em um iframe
                        window.location.href = urlToLoad; // Navega a janela atual
                    }
                });
            } else {
                console.error("Botão 'Adicionar Novo Artigo' não encontrado.");
            }

            if (window.componentHandler) {
                window.componentHandler.upgradeDom();
            }
        });
